<div class="chatbot-container">
  <div class="chat-header">
    <div class="chat-title">
      <h1>ğŸ’¬ Mi Diario Emocional</h1>
      <p>Comparte tus pensamientos y emociones. La IA te responderÃ¡ con insights Ãºtiles.</p>
    </div>
  </div>

  <div #chatContainer class="chat-messages">
    <!-- Todos los mensajes -->
    <div *ngFor="let entry of entries" 
         class="message" 
         [class.user-message]="entry.type === 'user'" 
         [class.ai-message]="entry.type === 'ai'">
      
      <div class="message-avatar">
        {{ entry.type === 'user' ? 'ğŸ‘¤' : 'ğŸ¤–' }}
      </div>
      
      <div class="message-content">
        <div class="message-sender" *ngIf="entry.type === 'ai' && !entry.isWelcome">
          Asistente IA
        </div>
        
        <div class="message-text">{{ entry.text }}</div>
        
        <div class="message-analysis" *ngIf="entry.sentiment && entry.type === 'ai'">
          <span class="sentiment-badge" 
                [style.background-color]="getSentimentColor(entry.sentiment.sentiment.label)">
            {{ entry.sentiment.sentiment.label | uppercase }}
          </span>
          <span class="emotion-icon">
            {{ getEmotionIcon(entry.sentiment.emotion.label) }}
            {{ entry.sentiment.emotion.label }}
          </span>
        </div>
        
        <div class="message-time">
          {{ formatTime(entry.timestamp) }} â€¢ {{ formatDate(entry.timestamp) }}
        </div>
      </div>
    </div>

    <div *ngIf="entries.length === 1" class="empty-chat">
      <div class="empty-icon">ğŸ’­</div>
      <h3>AÃºn no hay conversaciones</h3>
      <p>EnvÃ­a un mensaje para comenzar tu diario emocional</p>
    </div>
  </div>

  <!-- Ãrea de entrada de mensajes -->
  <div class="chat-input-container">
    <div class="typing-indicator" *ngIf="isLoading">
      <div class="typing-dots">
        <span></span>
        <span></span>
        <span></span>
      </div>
      <span>La IA estÃ¡ respondiendo...</span>
    </div>

    <div class="input-wrapper">
      <textarea 
        [(ngModel)]="messageText" 
        placeholder="Escribe tu mensaje aquÃ­..." 
        rows="1"
        [disabled]="isLoading"
        (keydown.enter)="$event.preventDefault(); sendMessage()"
        class="message-input">
      </textarea>
      
      <button 
        (click)="sendMessage()" 
        [disabled]="isLoading || !messageText.trim()"
        class="send-button">
        <span *ngIf="!isLoading">â†‘</span>
        <span *ngIf="isLoading">â³</span>
      </button>
    </div>

    <div *ngIf="errorMessage" class="error-message">
      âŒ {{ errorMessage }}
    </div>

    <div *ngIf="successMessage" class="success-message">
      âœ… {{ successMessage }}
    </div>
  </div>
</div>